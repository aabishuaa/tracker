<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EY AI Taskforce Tracker</title>

    <!-- Favicon: EY Yellow block -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23FFE600'/></svg>">

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Quill.js for rich text editing -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    <!-- SheetJS for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- html2canvas for image export -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- Quill.js for rich text editing -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- EY Opening Animation -->
    <div class="ey-loading-overlay" id="eyLoadingOverlay">
        <div class="ey-animation-container">
            <div class="ey-logo-wrapper">
                <div class="ey-logo">
                    <div class="ey-letter ey-letter-e">E</div>
                    <div class="ey-letter ey-letter-y">Y</div>
                </div>
                <div class="ey-yellow-bar"></div>
            </div>
            <div class="ey-tagline">AI Taskforce</div>
            <div class="ey-subtitle">Action Items & Initiative Tracker</div>
            <div class="ey-loader">
                <div class="ey-loader-dot"></div>
                <div class="ey-loader-dot"></div>
                <div class="ey-loader-dot"></div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="header-accent"></div>
                <div class="header-titles">
                    <h1 class="header-title">EY AI Taskforce</h1>
                    <p class="header-subtitle">Action Items & Initiative Tracker</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" id="saveSnapshotBtn">
                    <i class="fas fa-camera"></i>
                    Save Snapshot
                </button>
                <button class="btn btn-secondary" id="viewSnapshotBtn">
                    <i class="fas fa-chart-bar"></i>
                    View Snapshot
                </button>
                <button class="btn btn-featured" id="meetingViewBtn">
                    <i class="fas fa-presentation-screen"></i>
                    Meeting View
                </button>
                <button class="btn btn-primary" id="previewReportBtn">
                    <i class="fas fa-eye"></i>
                    Preview Report
                </button>
                <button class="btn btn-primary" id="generateReportBtn">
                    <i class="fas fa-file-alt"></i>
                    Generate Report
                </button>
                <button class="btn btn-success" id="exportReportExcelBtn" title="Export report to Excel">
                    <i class="fas fa-file-excel"></i>
                    Export Excel Report
                </button>
                <button class="btn btn-success" id="exportReportImageBtn" title="Export report as image">
                    <i class="fas fa-image"></i>
                    Export Report (Image)
                </button>
            </div>
        </div>
    </header>

    <!-- Tab Navigation -->
    <div class="tab-bar">
        <div class="tab-nav">
            <button class="tab-button active" data-tab="action-items">
                Action Items
            </button>
            <button class="tab-button" data-tab="calendar-events">
                Calendar & Events
            </button>
            <button class="tab-button" data-tab="snapshot-view">
                Project Snapshot
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Action Items Tab -->
        <div id="action-items" class="tab-content active">
            <div class="action-items-layout">
                <!-- Action Items Table Section -->
                <div>
                    <div class="section-header">
                        <div class="section-header-left">
                            <h2 class="section-title">Action Items</h2>
                            <div class="current-date-badge" id="currentDateBadge"></div>
                        </div>
                        <div class="table-controls">
                            <div class="search-wrapper">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-box" id="searchBox" placeholder="Search action items...">
                            </div>
                            <div class="filter-wrapper">
                                <i class="fas fa-filter filter-icon"></i>
                                <select class="filter-select" id="statusFilter">
                                    <option value="">All Statuses</option>
                                    <option value="Not Started">Not Started</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Blocked">Blocked</option>
                                    <option value="Done">Done</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="addItemBtn">
                                <i class="fas fa-plus"></i>
                                Add Action Item
                            </button>
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <table class="action-table">
                            <thead>
                                <tr>
                                    <th data-sort="description">Task Name <i class="fas fa-sort"></i></th>
                                    <th data-sort="owner">Owner <i class="fas fa-sort"></i></th>
                                    <th data-sort="taskforce">Taskforce <i class="fas fa-sort"></i></th>
                                    <th data-sort="date">Due Date <i class="fas fa-sort"></i></th>
                                    <th data-sort="status">Status <i class="fas fa-sort"></i></th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="actionTableBody">
                                <!-- Table rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Details Panel -->
                <div class="details-panel" id="detailsPanel">
                    <div class="details-panel-empty">
                        <i class="fas fa-file-alt"></i>
                        <p>Select an action item to view details</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calendar & Events Tab -->
        <div id="calendar-events" class="tab-content">
            <div class="calendar-section">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <div class="calendar-month-nav">
                            <button class="calendar-nav-btn" id="prevMonthBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h3 class="calendar-month-title" id="calendarMonthTitle">December 2025</h3>
                            <button class="calendar-nav-btn" id="nextMonthBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <button class="btn btn-primary btn-sm" id="todayBtn">
                            <i class="fas fa-calendar-day"></i>
                            Today
                        </button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be rendered here -->
                    </div>
                </div>

                <div class="events-container">
                    <div class="events-header">
                        <h3 class="events-title">Upcoming Events</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary btn-sm" id="exportCalendarBtn" title="Export calendar events to Excel">
                                <i class="fas fa-file-excel"></i>
                                Export
                            </button>
                            <button class="btn btn-primary btn-sm" id="addEventBtn">
                                <i class="fas fa-plus"></i>
                                Add Event
                            </button>
                        </div>
                    </div>
                    <div class="events-list" id="eventsList">
                        <!-- Events will be rendered here -->
                    </div>
                    <div class="events-pagination">
                        <button class="pagination-btn" id="eventsPrevBtn" onclick="window.calendar.navigateEventsPage(-1)">
                            <i class="fas fa-chevron-left"></i>
                            Previous
                        </button>
                        <span class="pagination-info" id="eventsPageInfo">0 / 0</span>
                        <button class="pagination-btn" id="eventsNextBtn" onclick="window.calendar.navigateEventsPage(1)">
                            Next
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snapshot Visualization Tab -->
        <div id="snapshot-view" class="tab-content">
            <div id="snapshotVizContainer" class="snapshot-viz-container">
                <!-- Snapshot visualization will be rendered here -->
            </div>
        </div>
    </main>

    <!-- Add/Edit Action Item Modal -->
    <div class="modal-overlay" id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="itemModalTitle">Add Action Item</h2>
                <button class="modal-close" id="closeItemModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="itemForm">
                    <div class="form-group">
                        <label class="form-label" for="itemDescription">Task Name / Description *</label>
                        <input type="text" class="form-input" id="itemDescription" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="itemOwner">Owner *</label>
                        <input type="text" class="form-input" id="itemOwner" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="itemTaskforce">Taskforce Members (comma-separated)</label>
                        <input type="text" class="form-input" id="itemTaskforce" placeholder="John Doe, Jane Smith">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="itemDate">Due Date *</label>
                        <input type="date" class="form-input" id="itemDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="itemStatus">Status</label>
                        <select class="form-select" id="itemStatus">
                            <option value="Not Started">Not Started</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Blocked">Blocked</option>
                            <option value="Done">Done</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="itemNotes">Notes</label>
                        <div id="itemNotesEditor" style="background: white; min-height: 150px;"></div>
                        <input type="hidden" id="itemNotes">
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelItemBtn">Cancel</button>
                <button class="btn btn-primary" id="saveItemBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Event Modal -->
    <div class="modal-overlay" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add Calendar Event</h2>
                <button class="modal-close" id="closeEventModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <div class="form-group">
                        <label class="form-label" for="eventTitle">Event Title *</label>
                        <input type="text" class="form-input" id="eventTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventDate">Date *</label>
                        <input type="date" class="form-input" id="eventDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventCategory">Category</label>
                        <select class="form-select" id="eventCategory">
                            <option value="Meeting">Meeting</option>
                            <option value="Deadline">Deadline</option>
                            <option value="Review">Review</option>
                            <option value="Workshop">Workshop</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventPoster">Event Poster (optional)</label>
                        <input type="file" class="form-input" id="eventPoster" accept="image/*">
                        <div id="eventPosterPreview" class="poster-preview" style="display: none;">
                            <img id="eventPosterImage" src="" alt="Event poster preview">
                            <button type="button" class="btn btn-danger btn-sm" id="removePosterBtn" style="margin-top: 0.5rem;">
                                <i class="fas fa-times"></i> Remove Poster
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventDescription">Description</label>
                        <div id="eventDescriptionEditor" style="background: white; min-height: 120px;"></div>
                        <input type="hidden" id="eventDescription">
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelEventBtn">Cancel</button>
                <button class="btn btn-primary" id="saveEventBtn">Add Event</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Deletion</h2>
                <button class="modal-close" id="closeDeleteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="deleteMessage" style="font-size: 1rem; color: #2D3748; line-height: 1.6;">
                    Are you sure you want to delete this item? This action cannot be undone.
                </p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelDeleteBtn">Cancel</button>
                <button class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Item Details Modal -->
    <div class="modal-overlay" id="itemDetailsModal">
        <div class="modal-content modal-content-large">
            <div class="modal-header">
                <h2 class="modal-title">Item Details</h2>
                <button class="modal-close" id="closeItemDetailsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="itemDetailsContent">
                    <!-- Item details will be rendered here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="editItemDetailsBtn">
                    <i class="fas fa-edit"></i>
                    Edit
                </button>
                <button class="btn btn-danger" id="deleteItemDetailsBtn">
                    <i class="fas fa-trash-alt"></i>
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Event Details Modal -->
    <div class="modal-overlay" id="eventDetailsModal">
        <div class="modal-content modal-content-large">
            <div class="modal-header">
                <h2 class="modal-title">Event Details</h2>
                <button class="modal-close" id="closeEventDetailsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="eventDetailsContent">
                    <!-- Event details will be rendered here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="editEventDetailsBtn">
                    <i class="fas fa-edit"></i>
                    Edit
                </button>
                <button class="btn btn-danger" id="deleteEventDetailsBtn">
                    <i class="fas fa-trash-alt"></i>
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Status Update Menu -->
    <div class="status-menu" id="statusMenu">
        <div class="status-menu-item not-started" onclick="window.actionItems.updateItemStatus('Not Started')">
            <i class="fas fa-circle"></i>
            Not Started
        </div>
        <div class="status-menu-item in-progress" onclick="window.actionItems.updateItemStatus('In Progress')">
            <i class="fas fa-spinner"></i>
            In Progress
        </div>
        <div class="status-menu-item blocked" onclick="window.actionItems.updateItemStatus('Blocked')">
            <i class="fas fa-ban"></i>
            Blocked
        </div>
        <div class="status-menu-item done" onclick="window.actionItems.updateItemStatus('Done')">
            <i class="fas fa-check-circle"></i>
            Done
        </div>
    </div>

    <!-- Meeting Presentation View -->
    <div class="meeting-view-overlay" id="meetingViewOverlay">
        <div class="meeting-view-container">
            <!-- Meeting View Header -->
            <div class="meeting-view-header">
                <div class="meeting-view-header-left">
                    <div class="meeting-view-logo">
                        <div class="meeting-view-accent"></div>
                        <h1><span class="ey-accent">EY</span> AI Taskforce</h1>
                    </div>
                    <div class="meeting-view-date" id="meetingViewDate"></div>
                </div>
                <button class="meeting-view-close-btn" id="closeMeetingView">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Meeting Info Section -->
            <div class="meeting-info-section" id="meetingInfoSection">
                <div class="meeting-info-card">
                    <i class="fas fa-calendar-check"></i>
                    <div class="meeting-info-content">
                        <h3 class="meeting-info-title">Today's Meeting</h3>
                        <p class="meeting-info-subtitle" id="meetingInfoSubtitle">Review action items and track progress</p>
                    </div>
                </div>
                <div class="meeting-view-stats" id="meetingViewStats">
                    <!-- Stats will be populated by JS -->
                </div>
            </div>

            <!-- Meeting View Controls -->
            <div class="meeting-view-controls">
                <div class="meeting-view-filters">
                    <button class="meeting-filter-btn active" data-filter="all">
                        <i class="fas fa-list"></i>
                        All Items
                    </button>
                    <button class="meeting-filter-btn" data-filter="overdue">
                        <i class="fas fa-exclamation-circle"></i>
                        Overdue
                    </button>
                    <button class="meeting-filter-btn" data-filter="in-progress">
                        <i class="fas fa-spinner"></i>
                        In Progress
                    </button>
                    <button class="meeting-filter-btn" data-filter="blocked">
                        <i class="fas fa-ban"></i>
                        Blocked
                    </button>
                </div>
            </div>

            <!-- Meeting View Content -->
            <div class="meeting-view-content" id="meetingViewContent">
                <!-- Action items will be populated by JS -->
            </div>

            <!-- Meeting View Navigation -->
            <div class="meeting-view-nav" id="meetingViewNav">
                <button class="meeting-nav-btn" id="meetingPrevBtn">
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <div class="meeting-page-info">
                    <div class="meeting-page-indicator" id="meetingPageIndicator">
                        Page <span id="meetingCurrentPage">1</span> / <span id="meetingTotalPages">1</span>
                    </div>
                    <div class="meeting-showing-info" id="meetingShowingInfo">
                        Showing 0-0 of 0
                    </div>
                </div>
                <button class="meeting-nav-btn" id="meetingNextBtn">
                    Next
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Meeting Card Details Modal -->
    <div class="meeting-card-modal" id="meetingCardModal">
        <div class="meeting-modal-content">
            <!-- Modal content will be populated by JS -->
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle toast-icon"></i>
        <span class="toast-message" id="toastMessage"></span>
    </div>

    <!-- External JavaScript (ES6 Modules) -->
    <script type="module" src="js/core/app.js"></script>
</body>
</html>
